windows上第一次运行系统的操作步骤

一、安装配置必要的组件
  MySQL、Redis、MongoDB、Zookeeper、Kafka

二、执行
1.MySQL
1.1 启动MySQL

mysql -u root -p 
123456

增加T-Box的数据库：
create database tboxdb;
use tboxdb;

CREATE TABLE `tboxfactorydata_tbl` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `tboxserialno` VARCHAR(29) NOT NULL,
    `pretboxaes128key` VARCHAR(16) NOT NULL,
    `vin` VARCHAR(17) NOT NULL,
    `iccid` VARCHAR(20) NOT NULL,
    `imsi` VARCHAR(15) NOT NULL,
    `status` TINYINT NOT NULL,
    `bid` INT UNSIGNED NOT NULL,
    `tboxaes128key` VARCHAR(16) NOT NULL,
    `eventcreationtime` INT UNSIGNED NOT NULL,
    PRIMARY KEY(`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO tboxfactorydata_tbl (tboxserialno,pretboxaes128key,vin,iccid,imsi,status,bid,tboxaes128key,eventcreationtime) VALUES (
    "12345678901234567890123456789",
    "1234567890123456",
    "WDDUX52684DFR4582",
    "12345678901234567890",
    "HGTSN12584UHGTE",
    0,
    0,
    "1234567890123456",
    0);



增加iov后台的数据库：
create database iovdb;
use iovdb;

CREATE TABLE `tboxbaseinfo_tbl` (
    `id` INT NOT NULL AUTO_INCREMENT,
    `tboxserialno` VARCHAR(29) NOT NULL,
    `pretboxaes128key` VARCHAR(16) NOT NULL,
    `vin` VARCHAR(17) NOT NULL,
    `iccid` VARCHAR(20) NOT NULL,
    `imsi` VARCHAR(15) NOT NULL,
    `status` TINYINT NOT NULL,
    `bid` INT UNSIGNED NOT NULL,
    `tboxaes128key` VARCHAR(16) NOT NULL,
    `eventcreationtime` INT UNSIGNED NOT NULL,
    PRIMARY KEY(`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO tboxbaseinfo_tbl (tboxserialno,pretboxaes128key,vin,iccid,imsi,status,bid,tboxaes128key,eventcreationtime) VALUES (
    "12345678901234567890123456789",
    "1234567890123456",
    "WDDUX52684DFR4582",
    "12345678901234567890",
    "HGTSN12584UHGTE",
    0,
    0,
    "1234567890123456",
    0);

CREATE TABLE `VehicleStatusInfor_tbl` (
    `id` INT NOT NULL AUTO_INCREMENT,

    `ResidualMileage` INT NOT NULL,
    `OdographMeter` INT NOT NULL,
    `MaintainMileage` INT NOT NULL,
    `Fuel` SMALLINT NOT NULL,
    `AverageFuleCut` FLOAT NOT NULL,
    `AverageSpeed` INT NOT NULL,
    `VehicleInstantaneousSpeed` DOUBLE NOT NULL,

    `WheelSpeed_FL` DOUBLE NOT NULL,
    `WheelSpeed_FR` DOUBLE NOT NULL,
    `WheelSpeed_RL` DOUBLE NOT NULL,
    `WheelSpeed_RR` DOUBLE NOT NULL,

    `WheelTyrePressure_FL` FLOAT NOT NULL,
    `WheelTyrePressure_FR` FLOAT NOT NULL,
    `WheelTyrePressure_RL` FLOAT NOT NULL,
    `WheelTyrePressure_RR` FLOAT NOT NULL,

    `WheelTyreTemperature_FL` FLOAT NOT NULL,
    `WheelTyreTemperature_FR` FLOAT NOT NULL,
    `WheelTyreTemperature_RL` FLOAT NOT NULL,
    `WheelTyreTemperature_RR` FLOAT NOT NULL,

    `SteeringAngularSpeed` INT NOT NULL,
    `SteeringAngle` INT NOT NULL,

    `tbox_id` INT NOT NULL,

    PRIMARY KEY(`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE VehicleStatusInfor_tbl ADD CONSTRAINT VehicleStatusInfor_FK_ID FOREIGN KEY(tbox_id) REFERENCES tboxbaseinfo_tbl(id);


CREATE TABLE `EngineStatusInfor_tbl` (
    `id` INT NOT NULL AUTO_INCREMENT,

    `EngineSpeed` DOUBLE NOT NULL,
    `EngineRunTime` INT NOT NULL,
    `VehicleRunTime` INT NOT NULL,
    `EngState` TINYINT NOT NULL,
    `GearLevPos` TINYINT NOT NULL,

    `tbox_id` INT NOT NULL,

    PRIMARY KEY(`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE EngineStatusInfor_tbl ADD CONSTRAINT EngineStatusInfor_FK_ID FOREIGN KEY(tbox_id) REFERENCES tboxbaseinfo_tbl(id);

CREATE TABLE `VehicleGpsInfor_tbl` (
    `id` INT NOT NULL AUTO_INCREMENT,

    `Latitude` DOUBLE NOT NULL,
    `Longitude` DOUBLE NOT NULL,
    `Altitude` DOUBLE NOT NULL,
    `Speed` DOUBLE NOT NULL,
    `Bearing` DOUBLE NOT NULL,
    `Accuracy` DOUBLE NOT NULL,
    `Time` BIGINT  NOT NULL,

    `tbox_id` INT NOT NULL,

    PRIMARY KEY(`id`)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE VehicleGpsInfor_tbl ADD CONSTRAINT VehicleGpsInfor_FK_ID FOREIGN KEY(tbox_id) REFERENCES tboxbaseinfo_tbl(id);



DBHostIP   = "127.0.0.1:3306"
DBUsername = "root"
DBPassword = "123456"
DriverName = "mysql"


2.Redis
cd D:\redis
redis-server.exe redis.windows.conf

#redis-cli.exe -h 127.0.0.1 -p 6379
#KEYS *
#FLUSHALL
#KEYS *

REDIS_ADDR     = "localhost:6379"

3.MongoDB
NET START mongodb

MgoAddr = "localhost:27017"

4.Zookeeper
zkserver

zookeeper.connect=localhost:2181

5.Kafka
cd D:\kafka_2.12-1.0.0
bin\windows\kafka-server-start.bat config\server.properties

MQAddr             = "localhost:9092"

cd D:\kafka_2.12-1.0.0
bin\windows\kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 10 --topic TspToIov
bin\windows\kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 10 --topic IovToTsp

bin\windows\kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 10 --topic FinanceLeaseLockCarToGateway
bin\windows\kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 10 --topic GatewayToFinanceLeaseLockCar

bin\windows\kafka-console-producer.bat --broker-list localhost:9092 --topic FinanceLeaseLockCarToGateway
bin\windows\kafka-console-consumer.bat --zookeeper localhost:2181 --topic GatewayToFinanceLeaseLockCar


bin\windows\kafka-console-consumer.bat --zookeeper localhost:2181 --topic FinanceLeaseLockCarToGateway

6.iov
  cd E:\golang\src\hcxy\iov\iov_server
  监听1235端口

7.iov_client
  cd E:\golang\src\hcxy\iov\iov_client
  TSP监听1236端口
  tbox当前连接1235端口
  